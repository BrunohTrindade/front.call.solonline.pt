import{b as _s,r as d,e as Rs,j as e,c as Q,d as Is,h as ns,f as De,g as Us,i as Xs,m as Ks,k as os,l as Z,n as ce,u as Ys,o as Js,p as Qs,a as Zs,q as ze,s as _,_ as rs}from"./index-DUMhbAof.js";import{s as Ns,u as Ws,c as ee,g as se,a as te,b as et,d as ve,m as _e,e as pe,A as st,T as tt,B as x,f as q,h as u,C as U,i as is,I as ls,L as cs,D as ds,j as ps,k as ms,M as at,l as nt,n as ot,o as Te,p as Me,q as Re,S as rt,r as qe,P as F}from"./Menu-D2QxTdDQ.js";import{A as us}from"./ArrowBack-Dc0QBD59.js";import{i as it,P as xs,A as Ie,F as Fe,I as Oe,S as Le,M as J,a as lt,D as ct,b as dt,c as pt,d as mt,e as ut}from"./PeopleOutline-Bd9CJoFf.js";const xt=(s,a)=>s.filter(n=>a.includes(n)),me=(s,a,n)=>{const r=s.keys[0];Array.isArray(a)?a.forEach((l,o)=>{n((m,j)=>{o<=s.keys.length-1&&(o===0?Object.assign(m,j):m[s.up(s.keys[o])]=j)},l)}):a&&typeof a=="object"?(Object.keys(a).length>s.keys.length?s.keys:xt(s.keys,Object.keys(a))).forEach(o=>{if(s.keys.includes(o)){const m=a[o];m!==void 0&&n((j,g)=>{r===o?Object.assign(j,g):j[s.up(o)]=g},m)}}):(typeof a=="number"||typeof a=="string")&&n((l,o)=>{Object.assign(l,o)},a)};function Ne(s){return`--Grid-${s}Spacing`}function We(s){return`--Grid-parent-${s}Spacing`}const fs="--Grid-columns",de="--Grid-parent-columns",ft=({theme:s,ownerState:a})=>{const n={};return me(s.breakpoints,a.size,(r,l)=>{let o={};l==="grow"&&(o={flexBasis:0,flexGrow:1,maxWidth:"100%"}),l==="auto"&&(o={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof l=="number"&&(o={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${l} / var(${de}) - (var(${de}) - ${l}) * (var(${We("column")}) / var(${de})))`}),r(n,o)}),n},ht=({theme:s,ownerState:a})=>{const n={};return me(s.breakpoints,a.offset,(r,l)=>{let o={};l==="auto"&&(o={marginLeft:"auto"}),typeof l=="number"&&(o={marginLeft:l===0?"0px":`calc(100% * ${l} / var(${de}) + var(${We("column")}) * ${l} / var(${de}))`}),r(n,o)}),n},gt=({theme:s,ownerState:a})=>{if(!a.container)return{};const n={[fs]:12};return me(s.breakpoints,a.columns,(r,l)=>{const o=l??12;r(n,{[fs]:o,"> *":{[de]:o}})}),n},yt=({theme:s,ownerState:a})=>{if(!a.container)return{};const n={};return me(s.breakpoints,a.rowSpacing,(r,l)=>{var m;const o=typeof l=="string"?l:(m=s.spacing)==null?void 0:m.call(s,l);r(n,{[Ne("row")]:o,"> *":{[We("row")]:o}})}),n},bt=({theme:s,ownerState:a})=>{if(!a.container)return{};const n={};return me(s.breakpoints,a.columnSpacing,(r,l)=>{var m;const o=typeof l=="string"?l:(m=s.spacing)==null?void 0:m.call(s,l);r(n,{[Ne("column")]:o,"> *":{[We("column")]:o}})}),n},jt=({theme:s,ownerState:a})=>{if(!a.container)return{};const n={};return me(s.breakpoints,a.direction,(r,l)=>{r(n,{flexDirection:l})}),n},vt=({ownerState:s})=>({minWidth:0,boxSizing:"border-box",...s.container&&{display:"flex",flexWrap:"wrap",...s.wrap&&s.wrap!=="wrap"&&{flexWrap:s.wrap},gap:`var(${Ne("row")}) var(${Ne("column")})`}}),St=s=>{const a=[];return Object.entries(s).forEach(([n,r])=>{r!==!1&&r!==void 0&&a.push(`grid-${n}-${String(r)}`)}),a},wt=(s,a="xs")=>{function n(r){return r===void 0?!1:typeof r=="string"&&!Number.isNaN(Number(r))||typeof r=="number"&&r>0}if(n(s))return[`spacing-${a}-${String(s)}`];if(typeof s=="object"&&!Array.isArray(s)){const r=[];return Object.entries(s).forEach(([l,o])=>{n(o)&&r.push(`spacing-${l}-${String(o)}`)}),r}return[]},Ct=s=>s===void 0?[]:typeof s=="object"?Object.entries(s).map(([a,n])=>`direction-${a}-${n}`):[`direction-xs-${String(s)}`];function kt(s,a){s.item!==void 0&&delete s.item,s.zeroMinWidth!==void 0&&delete s.zeroMinWidth,a.keys.forEach(n=>{s[n]!==void 0&&delete s[n]})}const zt=Is(),Tt=Ns("div",{name:"MuiGrid",slot:"Root"});function Mt(s){return Ws({props:s,name:"MuiGrid",defaultTheme:zt})}function Rt(s={}){const{createStyledComponent:a=Tt,useThemeProps:n=Mt,useTheme:r=_s,componentName:l="MuiGrid"}=s,o=(p,b)=>{const{container:T,direction:C,spacing:k,wrap:w,size:N}=p,S={root:["root",T&&"container",w!=="wrap"&&`wrap-xs-${String(w)}`,...Ct(C),...St(N),...T?wt(k,b.breakpoints.keys[0]):[]]};return ee(S,I=>se(l,I),{})};function m(p,b,T=()=>!0){const C={};return p===null||(Array.isArray(p)?p.forEach((k,w)=>{k!==null&&T(k)&&b.keys[w]&&(C[b.keys[w]]=k)}):typeof p=="object"?Object.keys(p).forEach(k=>{const w=p[k];w!=null&&T(w)&&(C[k]=w)}):C[b.keys[0]]=p),C}const j=a(gt,bt,yt,ft,jt,vt,ht),g=d.forwardRef(function(b,T){const C=r(),k=n(b),w=Rs(k);kt(w,C.breakpoints);const{className:N,children:S,columns:I=12,container:f=!1,component:$="div",direction:B="row",wrap:V="wrap",size:Se={},offset:X={},spacing:ue=0,rowSpacing:O=ue,columnSpacing:D=ue,unstable_level:K=0,...L}=w,xe=m(Se,C.breakpoints,A=>A!==!1),Ue=m(X,C.breakpoints),ae=b.columns??(K?void 0:I),Xe=b.spacing??(K?void 0:ue),ne=b.rowSpacing??b.spacing??(K?void 0:O),G=b.columnSpacing??b.spacing??(K?void 0:D),oe={...w,level:K,columns:ae,container:f,direction:B,wrap:V,spacing:Xe,rowSpacing:ne,columnSpacing:G,size:xe,offset:Ue},we=o(oe,C);return e.jsx(j,{ref:T,as:$,ownerState:oe,className:Q(we.root,N),...L,children:d.Children.map(S,A=>{var Ce;return d.isValidElement(A)&&it(A,["Grid"])&&f&&A.props.container?d.cloneElement(A,{unstable_level:((Ce=A.props)==null?void 0:Ce.unstable_level)??K+1}):A})})});return g.muiName="Grid",g}const It=Is(),Nt=Ns("div",{name:"MuiStack",slot:"Root"});function Wt(s){return Ws({props:s,name:"MuiStack",defaultTheme:It})}function $t(s,a){const n=d.Children.toArray(s).filter(Boolean);return n.reduce((r,l,o)=>(r.push(l),o<n.length-1&&r.push(d.cloneElement(a,{key:`separator-${o}`})),r),[])}const Ht=s=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[s],At=({ownerState:s,theme:a})=>{let n={display:"flex",flexDirection:"column",...ns({theme:a},De({values:s.direction,breakpoints:a.breakpoints.values}),r=>({flexDirection:r}))};if(s.spacing){const r=Us(a),l=Object.keys(a.breakpoints.values).reduce((g,p)=>((typeof s.spacing=="object"&&s.spacing[p]!=null||typeof s.direction=="object"&&s.direction[p]!=null)&&(g[p]=!0),g),{}),o=De({values:s.direction,base:l}),m=De({values:s.spacing,base:l});typeof o=="object"&&Object.keys(o).forEach((g,p,b)=>{if(!o[g]){const C=p>0?o[b[p-1]]:"column";o[g]=C}}),n=Xs(n,ns({theme:a},m,(g,p)=>s.useFlexGap?{gap:os(r,g)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${Ht(p?o[p]:s.direction)}`]:os(r,g)}}))}return n=Ks(a.breakpoints,n),n};function Pt(s={}){const{createStyledComponent:a=Nt,useThemeProps:n=Wt,componentName:r="MuiStack"}=s,l=()=>ee({root:["root"]},g=>se(r,g),{}),o=a(At);return d.forwardRef(function(g,p){const b=n(g),T=Rs(b),{component:C="div",direction:k="column",spacing:w=0,divider:N,children:S,className:I,useFlexGap:f=!1,...$}=T,B={direction:k,spacing:w,useFlexGap:f},V=l();return e.jsx(o,{as:C,ownerState:B,ref:p,className:Q(V.root,I),...$,children:N?$t(S,N):S})})}const Ge=Rt({createStyledComponent:te("div",{name:"MuiGrid",slot:"Root",overridesResolver:(s,a)=>{const{ownerState:n}=s;return[a.root,n.container&&a.container]}}),componentName:"MuiGrid",useThemeProps:s=>Z({props:s,name:"MuiGrid"}),useTheme:et}),je=Pt({createStyledComponent:te("div",{name:"MuiStack",slot:"Root"}),useThemeProps:s=>Z({props:s,name:"MuiStack"})}),$s=d.createContext();function Et(s){return se("MuiTable",s)}ve("MuiTable",["root","stickyHeader"]);const Bt=s=>{const{classes:a,stickyHeader:n}=s;return ee({root:["root",n&&"stickyHeader"]},Et,a)},Vt=te("table",{name:"MuiTable",slot:"Root",overridesResolver:(s,a)=>{const{ownerState:n}=s;return[a.root,n.stickyHeader&&a.stickyHeader]}})(_e(({theme:s})=>({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":{...s.typography.body2,padding:s.spacing(2),color:(s.vars||s).palette.text.secondary,textAlign:"left",captionSide:"bottom"},variants:[{props:({ownerState:a})=>a.stickyHeader,style:{borderCollapse:"separate"}}]}))),hs="table",gs=d.forwardRef(function(a,n){const r=Z({props:a,name:"MuiTable"}),{className:l,component:o=hs,padding:m="normal",size:j="medium",stickyHeader:g=!1,...p}=r,b={...r,component:o,padding:m,size:j,stickyHeader:g},T=Bt(b),C=d.useMemo(()=>({padding:m,size:j,stickyHeader:g}),[m,j,g]);return e.jsx($s.Provider,{value:C,children:e.jsx(Vt,{as:o,role:o===hs?null:"table",ref:n,className:Q(T.root,l),ownerState:b,...p})})}),$e=d.createContext();function Dt(s){return se("MuiTableBody",s)}ve("MuiTableBody",["root"]);const qt=s=>{const{classes:a}=s;return ee({root:["root"]},Dt,a)},Ft=te("tbody",{name:"MuiTableBody",slot:"Root"})({display:"table-row-group"}),Ot={variant:"body"},ys="tbody",bs=d.forwardRef(function(a,n){const r=Z({props:a,name:"MuiTableBody"}),{className:l,component:o=ys,...m}=r,j={...r,component:o},g=qt(j);return e.jsx($e.Provider,{value:Ot,children:e.jsx(Ft,{className:Q(g.root,l),as:o,ref:n,role:o===ys?null:"rowgroup",ownerState:j,...m})})});function Lt(s){return se("MuiTableCell",s)}const Gt=ve("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),_t=s=>{const{classes:a,variant:n,align:r,padding:l,size:o,stickyHeader:m}=s,j={root:["root",n,m&&"stickyHeader",r!=="inherit"&&`align${ce(r)}`,l!=="normal"&&`padding${ce(l)}`,`size${ce(o)}`]};return ee(j,Lt,a)},Ut=te("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(s,a)=>{const{ownerState:n}=s;return[a.root,a[n.variant],a[`size${ce(n.size)}`],n.padding!=="normal"&&a[`padding${ce(n.padding)}`],n.align!=="inherit"&&a[`align${ce(n.align)}`],n.stickyHeader&&a.stickyHeader]}})(_e(({theme:s})=>({...s.typography.body2,display:"table-cell",verticalAlign:"inherit",borderBottom:s.vars?`1px solid ${s.vars.palette.TableCell.border}`:`1px solid
    ${s.palette.mode==="light"?s.lighten(s.alpha(s.palette.divider,1),.88):s.darken(s.alpha(s.palette.divider,1),.68)}`,textAlign:"left",padding:16,variants:[{props:{variant:"head"},style:{color:(s.vars||s).palette.text.primary,lineHeight:s.typography.pxToRem(24),fontWeight:s.typography.fontWeightMedium}},{props:{variant:"body"},style:{color:(s.vars||s).palette.text.primary}},{props:{variant:"footer"},style:{color:(s.vars||s).palette.text.secondary,lineHeight:s.typography.pxToRem(21),fontSize:s.typography.pxToRem(12)}},{props:{size:"small"},style:{padding:"6px 16px",[`&.${Gt.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}}},{props:{padding:"checkbox"},style:{width:48,padding:"0 0 0 4px"}},{props:{padding:"none"},style:{padding:0}},{props:{align:"left"},style:{textAlign:"left"}},{props:{align:"center"},style:{textAlign:"center"}},{props:{align:"right"},style:{textAlign:"right",flexDirection:"row-reverse"}},{props:{align:"justify"},style:{textAlign:"justify"}},{props:({ownerState:a})=>a.stickyHeader,style:{position:"sticky",top:0,zIndex:2,backgroundColor:(s.vars||s).palette.background.default}}]}))),H=d.forwardRef(function(a,n){const r=Z({props:a,name:"MuiTableCell"}),{align:l="inherit",className:o,component:m,padding:j,scope:g,size:p,sortDirection:b,variant:T,...C}=r,k=d.useContext($s),w=d.useContext($e),N=w&&w.variant==="head";let S;m?S=m:S=N?"th":"td";let I=g;S==="td"?I=void 0:!I&&N&&(I="col");const f=T||w&&w.variant,$={...r,align:l,component:S,padding:j||(k&&k.padding?k.padding:"normal"),size:p||(k&&k.size?k.size:"medium"),sortDirection:b,stickyHeader:f==="head"&&k&&k.stickyHeader,variant:f},B=_t($);let V=null;return b&&(V=b==="asc"?"ascending":"descending"),e.jsx(Ut,{as:S,ref:n,className:Q(B.root,o),"aria-sort":V,scope:I,ownerState:$,...C})});function Xt(s){return se("MuiTableHead",s)}ve("MuiTableHead",["root"]);const Kt=s=>{const{classes:a}=s;return ee({root:["root"]},Xt,a)},Yt=te("thead",{name:"MuiTableHead",slot:"Root"})({display:"table-header-group"}),Jt={variant:"head"},js="thead",vs=d.forwardRef(function(a,n){const r=Z({props:a,name:"MuiTableHead"}),{className:l,component:o=js,...m}=r,j={...r,component:o},g=Kt(j);return e.jsx($e.Provider,{value:Jt,children:e.jsx(Yt,{as:o,className:Q(g.root,l),ref:n,role:o===js?null:"rowgroup",ownerState:j,...m})})});function Qt(s){return se("MuiTableRow",s)}const Ss=ve("MuiTableRow",["root","selected","hover","head","footer"]),Zt=s=>{const{classes:a,selected:n,hover:r,head:l,footer:o}=s;return ee({root:["root",n&&"selected",r&&"hover",l&&"head",o&&"footer"]},Qt,a)},ea=te("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(s,a)=>{const{ownerState:n}=s;return[a.root,n.head&&a.head,n.footer&&a.footer]}})(_e(({theme:s})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${Ss.hover}:hover`]:{backgroundColor:(s.vars||s).palette.action.hover},[`&.${Ss.selected}`]:{backgroundColor:s.alpha((s.vars||s).palette.primary.main,(s.vars||s).palette.action.selectedOpacity),"&:hover":{backgroundColor:s.alpha((s.vars||s).palette.primary.main,`${(s.vars||s).palette.action.selectedOpacity} + ${(s.vars||s).palette.action.hoverOpacity}`)}}}))),ws="tr",le=d.forwardRef(function(a,n){const r=Z({props:a,name:"MuiTableRow"}),{className:l,component:o=ws,hover:m=!1,selected:j=!1,...g}=r,p=d.useContext($e),b={...r,component:o,hover:m,selected:j,head:p&&p.variant==="head",footer:p&&p.variant==="footer"},T=Zt(b);return e.jsx(ea,{as:o,ref:n,className:Q(T.root,l),role:o===ws?null:"row",ownerState:b,...g})}),Cs=pe(e.jsx("path",{d:"M20 7h-5V4c0-1.1-.9-2-2-2h-2c-1.1 0-2 .9-2 2v3H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2M9 12c.83 0 1.5.67 1.5 1.5S9.83 15 9 15s-1.5-.67-1.5-1.5S8.17 12 9 12m3 6H6v-.75c0-1 2-1.5 3-1.5s3 .5 3 1.5zm1-9h-2V4h2zm5 7.5h-4V15h4zm0-3h-4V12h4z"})),ks=pe(e.jsx("path",{d:"M12 7V3H2v18h20V7zM6 19H4v-2h2zm0-4H4v-2h2zm0-4H4V9h2zm0-4H4V5h2zm4 12H8v-2h2zm0-4H8v-2h2zm0-4H8V9h2zm0-4H8V5h2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8zm-2-8h-2v2h2zm0 4h-2v2h2z"})),sa=pe(e.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M19 18H6c-2.21 0-4-1.79-4-4 0-2.05 1.53-3.76 3.56-3.97l1.07-.11.5-.95C8.08 7.14 9.94 6 12 6c2.62 0 4.88 1.86 5.39 4.43l.3 1.5 1.53.11c1.56.1 2.78 1.41 2.78 2.96 0 1.65-1.35 3-3 3M8 13h2.55v3h2.9v-3H16l-4-4z"})),zs=pe(e.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"})),Ts=pe(e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"})),Ms=pe(e.jsx("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z"}));function ra(){const{user:s,logout:a}=Ys(),{importCsv:n,importCsvWithProgress:r,getScript:l,saveScript:o}=Js(),{mode:m,toggle:j}=Qs(),g=Zs(),[p,b]=d.useState(null),[T,C]=d.useState(null),k=d.useRef(null),[w,N]=d.useState([]),[S,I]=d.useState([]),[f,$]=d.useState({empresa:"",nome:"",telefone:"",email:"",nif:""}),[B,V]=d.useState({total:0,valid:0,error:0,comNif:0,semNif:0,successRate:0}),[Se,X]=d.useState(""),[ue,O]=d.useState(!1),[D,K]=d.useState(20),[L,xe]=d.useState(1),[Ue,ae]=d.useState(""),[Xe,ne]=d.useState(0),[G,oe]=d.useState(!1),[we,A]=d.useState([]),[Ce,fe]=d.useState(""),[Ke,ke]=d.useState(null),[Hs,he]=d.useState(""),[ge,re]=d.useState(!1),[As,ie]=d.useState(!1),[Ye,He]=d.useState(""),[Ps,Je]=d.useState(!1),[Ae,Pe]=d.useState(null);d.useEffect(()=>{s&&!s.is_admin&&g("/movimentacao",{replace:!0})},[s]),d.useEffect(()=>{let t=!1;async function i(){try{const c=await l();t||He(String((c==null?void 0:c.script)||""))}catch{t||He(y=>y)}}return s!=null&&s.is_admin&&i(),()=>{t=!0}},[s]);const Ee=d.useRef(null),[Qe,Es]=d.useState(null);d.useEffect(()=>{const t=()=>{if(Ee.current){const i=Ee.current.offsetHeight;Es(i)}};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[w,f,B]);const Ze=(t,i=",")=>{const c=[];let y="",h=!1;for(let v=0;v<t.length;v++){const M=t[v];if(M==='"'){if(h&&t[v+1]==='"'){y+='"',v++;continue}h=!h;continue}if(M===i&&!h){c.push(y.trim()),y="";continue}y+=M}return c.push(y.trim()),c},Bs=t=>{const i=[",",";","	"];let c=",",y=1;for(const h of i){const v=Ze(t,h).length;v>y&&(y=v,c=h)}return c},es=(t="")=>t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z0-9]/g,""),Be=(t=[])=>{const i=new Set,c=P=>{for(const R of t){const z=es(R);if(P.includes(z)&&!i.has(R))return i.add(R),R}for(const R of t){const z=es(R);if(P.some(E=>z.includes(E))&&!i.has(R))return i.add(R),R}return""},y=c(["empresa","company","companhia","organizacao","organizacaoempresa","clienteempresa","cliente","denominacaosocial","nomeempresa"]),h=c(["nome","name","nomecompleto","fullname","contacto","contato","responsavel","responsavelnome","pessoa"]),v=c(["telemovel","telefone","phone","celular","whatsapp","whats","fone","mobile","contacto","contatophone"]),M=c(["email","e-mail","mail","correio","emailaddress"]),W=c(["nif","numcontribuinte","contribuinte","taxid","tax","vat","vatnumber","numerofiscal","nrfiscal","inscricao","numerocontribuinte"]);return{empresa:y,nome:h,telefone:v,email:M,nif:W}};async function ss(t){var c;if(b(t),C(null),X(""),N([]),I([]),A([]),fe(""),ke(null),he(""),!t)return;const i=((c=t.name)==null?void 0:c.toLowerCase())||"";if(i.endsWith(".csv")){he("csv");const y=new FileReader;y.onload=()=>{const v=String(y.result||"").split(/\r?\n/).filter(M=>M.trim().length>0);if(v.length){const M=Bs(v[0]),W=E=>Ze(E,M).map(Y=>Y.replace(/^\"|\"$/g,"").trim()),P=W(v[0]);N(P);const R=Be(P);$(R);const z=v.slice(1).map(E=>{const Y=W(E),ye={};return P.forEach((Ve,be)=>{ye[Ve]=Y[be]??""}),ye});I(z),re(!1),O(!0)}},y.readAsText(t)}else if(i.endsWith(".xls")||i.endsWith(".xlsx")){he(i.endsWith(".xlsx")?"xlsx":"xls");const y=new FileReader;y.onload=async()=>{try{const h=y.result;ke(h);const v=await rs(()=>import("./xlsx-D_0l8YDs.js"),[]),M=v.read(new Uint8Array(h),{type:"array"}),W=M.SheetNames||[];A(W);const P=W[0];fe(P);const R=M.Sheets[P],z=v.utils.sheet_to_json(R,{header:1,raw:!0,defval:""});if(z&&z.length>0){const E=(z[0]||[]).map(be=>String(be));N(E);const Y=Be(E);$(Y);const Ve=z.slice(1,1+200).map(be=>{const as={};return E.forEach((Ls,Gs)=>{as[Ls]=be[Gs]??""}),as});I(Ve),re(!1),O(!0)}}catch(h){console.error(h),X("Não foi possível ler a prévia do Excel. Você ainda pode importar normalmente no servidor."),$({empresa:"",nome:"",telefone:"",email:"",nif:""}),re(!1),O(!0)}},y.readAsArrayBuffer(t)}}async function Vs(t){if(!(!Ke||!t))try{const i=await rs(()=>import("./xlsx-D_0l8YDs.js"),[]),y=i.read(new Uint8Array(Ke),{type:"array"}).Sheets[t],h=i.utils.sheet_to_json(y,{header:1,raw:!0,defval:""});if(h&&h.length>0){const v=(h[0]||[]).map(z=>String(z));if(N(v),!Object.values(f).filter(Boolean).every(z=>v.includes(z))){const z=Be(v);$(z)}const R=h.slice(1,1+200).map(z=>{const E={};return v.forEach((Y,ye)=>{E[Y]=z[ye]??""}),E});I(R)}else N([]),I([])}catch(i){console.error(i),X("Falha ao carregar a planilha selecionada para prévia.")}}function Ds(t){var c;t.preventDefault();const i=(c=t.dataTransfer.files)==null?void 0:c[0];i&&ss(i)}function ts(t){t.preventDefault()}d.useEffect(()=>{const t=S.length;if(!ge||t===0){V(W=>({...W,total:t}));return}let i=0,c=0,y=0,h=0;const v=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;S.forEach(W=>{W[f.empresa],W[f.nome],W[f.telefone];const P=W[f.email]||"",R=f.nif&&W[f.nif]||"";R?y++:h++;let z=0;String(P).trim()&&!v.test(P)&&z++,String(R).trim()&&!qs(R)&&z++,z>0?c++:i++});const M=t?Math.round(i/t*100):0;V({total:t,valid:i,error:c,comNif:y,semNif:h,successRate:M})},[S,f,ge]);function qs(t){const i=String(t||"").replace(/\D/g,"");if(i.length!==9)return!1;const c=i.split("").map(Number);let h=11-(c[0]*9+c[1]*8+c[2]*7+c[3]*6+c[4]*5+c[5]*4+c[6]*3+c[7]*2)%11;return h>=10&&(h=0),c[8]===h}async function Fs(t){var i;if((i=t==null?void 0:t.preventDefault)==null||i.call(t),C(null),!!p){oe(!0),ae("upload"),ne(0);try{const c=await r(p,f,({stage:y,percent:h})=>{y&&ae(y),typeof h=="number"&&ne(h)});C({type:"success",text:`Importado: ${c.created||0} criados${c.updated?`, ${c.updated} atualizados`:""}`}),b(null),N([]),I([]),$({empresa:"",nome:"",telefone:"",email:"",nif:""}),V({total:0,valid:0,error:0,comNif:0,semNif:0,successRate:0}),X(""),A([]),fe(""),ke(null),he(""),re(!1),oe(!1),ae(""),ne(0),g("/movimentacao")}catch(c){oe(!1),ae(""),ne(0),C({type:"error",text:c.message||"Falha ao importar"})}}}function Os(t){!p||!ge||Fs(t)}return e.jsxs(e.Fragment,{children:[e.jsx(st,{position:"static",color:"default",enableColorOnDark:!0,sx:{bgcolor:"background.paper",borderBottom:t=>`1px solid ${t.palette.divider}`},children:e.jsxs(tt,{sx:{gap:2,minHeight:72},children:[e.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:1.5,flex:1,minWidth:0},children:[e.jsx(q,{component:ze,to:"/movimentacao",startIcon:e.jsx(us,{}),variant:"text",color:"inherit",size:"small",sx:{mr:1,fontWeight:700},children:"Voltar"}),e.jsx(x,{className:"app-brand","aria-hidden":!0,sx:{width:40,height:40,display:"grid",placeItems:"center",color:"primary.contrastText",bgcolor:"primary.main",borderRadius:1.2},children:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:[e.jsx("ellipse",{cx:"12",cy:"5",rx:"8",ry:"3",fill:"currentColor"}),e.jsx("path",{d:"M4 5v6c0 1.66 3.58 3 8 3s8-1.34 8-3V5",fill:"currentColor",opacity:".9"}),e.jsx("path",{d:"M4 11v6c0 1.66 3.58 3 8 3s8-1.34 8-3v-6",fill:"currentColor",opacity:".8"})]})}),e.jsxs(x,{sx:{minWidth:0},children:[e.jsx(u,{variant:"h6",sx:{fontWeight:700,lineHeight:1.15,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"Importação de Dados"}),e.jsx(u,{variant:"caption",color:"text.secondary",children:"CSV, XLS, XLSX"})]})]}),e.jsxs(x,{sx:{display:{xs:"none",sm:"flex"},alignItems:"center",gap:1.25},children:[e.jsx(U,{size:"small",variant:"filled",icon:e.jsx(x,{sx:{width:8,height:8,bgcolor:"success.main",borderRadius:"50%"}}),label:"Sistema Online",sx:t=>({bgcolor:_(t.palette.success.main,.12),color:t.palette.success.main,"& .MuiChip-icon":{color:t.palette.success.main},fontWeight:500,borderRadius:1.5})}),e.jsx(is,{title:m==="dark"?"Tema: Escuro (clique para Claro)":"Tema: Claro (clique para Escuro)",children:e.jsx(ls,{color:"inherit",onClick:j,"aria-label":"Alternar tema",sx:{borderRadius:2,transition:"all .2s ease","&:hover":{bgcolor:t=>_(t.palette.text.primary,.06),transform:"translateY(-1px)"}},children:m==="dark"?e.jsx(cs,{fontSize:"small"}):e.jsx(ds,{fontSize:"small"})})}),(s==null?void 0:s.is_admin)&&e.jsx(u,{variant:"body2",sx:{fontWeight:600},children:"Admin"}),(s==null?void 0:s.is_admin)&&e.jsx(q,{variant:"outlined",size:"small",startIcon:e.jsx(xs,{}),component:ze,to:"/admin/usuarios",sx:t=>({textTransform:"uppercase",letterSpacing:".35px",borderRadius:2,borderColor:_(t.palette.primary.main,.4),color:t.palette.primary.main,fontWeight:700,"&:hover":{borderColor:t.palette.primary.main,boxShadow:"0 2px 8px rgba(0,0,0,.08)"}}),children:"Usuários"}),e.jsx(ps,{orientation:"vertical",flexItem:!0,sx:{mx:.5,opacity:.4}}),s&&e.jsx(q,{variant:"text",color:"inherit",size:"small",startIcon:e.jsx(ms,{}),onClick:a,sx:{fontWeight:700,color:"text.primary","&:hover":{bgcolor:t=>_(t.palette.text.primary,.06)}},children:"Sair"})]}),e.jsx(x,{sx:{display:{xs:"flex",sm:"none"}},children:e.jsx(ls,{"aria-label":"Abrir menu",onClick:()=>ie(!0),children:e.jsx(at,{})})})]})}),e.jsx(nt,{anchor:"right",open:As,onClose:()=>ie(!1),sx:{display:{xs:"block",sm:"none"}},children:e.jsxs(x,{sx:{width:300},role:"presentation",onKeyDown:t=>{t.key==="Escape"&&ie(!1)},children:[e.jsxs(x,{sx:{p:2,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(u,{variant:"subtitle1",sx:{fontWeight:700},children:"Menu"}),e.jsx(U,{size:"small",label:"Sistema Online",color:"success",variant:"outlined"})]}),e.jsx(ps,{}),e.jsxs(ot,{children:[e.jsxs(Te,{onClick:()=>{j()},children:[e.jsx(Me,{children:m==="dark"?e.jsx(cs,{}):e.jsx(ds,{})}),e.jsx(Re,{primary:`Tema: ${m==="dark"?"Escuro":"Claro"}`}),e.jsx(rt,{edge:"end",checked:m==="dark",onChange:j})]}),e.jsxs(Te,{component:ze,to:"/movimentacao",onClick:()=>ie(!1),children:[e.jsx(Me,{children:e.jsx(us,{})}),e.jsx(Re,{primary:"Movimentação"})]}),(s==null?void 0:s.is_admin)&&e.jsxs(Te,{component:ze,to:"/admin/usuarios",onClick:()=>ie(!1),children:[e.jsx(Me,{children:e.jsx(xs,{})}),e.jsx(Re,{primary:"Usuários"})]}),s&&e.jsxs(Te,{onClick:()=>{ie(!1),a()},children:[e.jsx(Me,{children:e.jsx(ms,{})}),e.jsx(Re,{primary:"Sair"})]})]})]})}),e.jsx(x,{sx:{width:"100%",bgcolor:t=>t.palette.mode==="light"?"#f7f9fb":_("#ffffff",.03),pt:{xs:2,sm:3},pb:{xs:.5,sm:1},minHeight:"calc(100dvh - 72px)"},children:e.jsxs(qe,{maxWidth:!1,sx:{maxWidth:"1680px",mx:"auto",px:{xs:1.5,sm:2,md:2.5}},children:[e.jsxs(F,{variant:"outlined",sx:{p:2.5,mb:2,borderRadius:2},children:[e.jsx(u,{variant:"subtitle1",sx:{fontWeight:700,mb:.5,textAlign:"center"},children:"Carregar Arquivo"}),e.jsx(u,{variant:"body2",color:"text.secondary",sx:{mb:2,textAlign:"center"},children:"Faça upload de arquivos XLS ou CSV com os dados dos contatos"}),e.jsxs(x,{onDragOver:ts,onDragEnter:ts,onDrop:Ds,onClick:()=>{var t;return(t=k.current)==null?void 0:t.click()},sx:t=>({border:`2px dashed ${_(t.palette.text.primary,.2)}`,borderRadius:2,p:{xs:4,sm:5},textAlign:"center",bgcolor:t.palette.mode==="dark"?_("#ffffff",.03):"#fafbff",cursor:"pointer",minHeight:{xs:180,sm:300},display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}),children:[e.jsx(sa,{sx:{fontSize:{xs:40,sm:48},color:"primary.main"}}),e.jsx(u,{sx:{fontWeight:700,mt:1},children:"Arraste e solte seu arquivo aqui"}),e.jsx(u,{variant:"body2",color:"text.secondary",children:"ou clique para selecionar um arquivo"}),e.jsxs(x,{sx:{mt:1.5,display:"flex",gap:1,justifyContent:"center",alignItems:"center",flexWrap:"wrap"},children:[e.jsx(U,{label:"CSV",size:"small",color:"success",variant:"outlined"}),e.jsx(U,{label:"XLS",size:"small",color:"primary",variant:"outlined"}),e.jsx(U,{label:"XLSX",size:"small",color:"info",variant:"outlined"}),e.jsx(u,{variant:"caption",color:"text.secondary",children:"Tamanho máximo: 100 MB"})]})]}),e.jsx("input",{ref:k,type:"file",accept:".csv,.xls,.xlsx",onChange:t=>{var i;return ss(((i=t.target.files)==null?void 0:i[0])||null)},style:{display:"none"}}),p&&e.jsxs(u,{variant:"body2",sx:{mt:1},children:["Arquivo selecionado: ",e.jsx("strong",{children:p.name})]}),Se&&e.jsx(Ie,{severity:"info",sx:{mt:1},children:Se})]}),e.jsxs(Ge,{container:!0,spacing:0,children:[e.jsx(Ge,{item:!0,xs:12,sm:!0,sx:{pr:{xs:0,sm:.5},flexBasis:{sm:"60%",md:"60%",lg:"60%"},maxWidth:{sm:"60%",md:"60%",lg:"60%"}},children:e.jsx(x,{sx:{width:"100%"},children:e.jsxs(F,{variant:"outlined",sx:{p:2.5,mb:2,borderRadius:2},children:[e.jsx(u,{variant:"subtitle1",sx:{fontWeight:700,mb:.5},children:"Mapeamento de Campos"}),e.jsx(u,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Configure como os campos do arquivo correspondem aos campos do sistema. Se algum campo não existir no arquivo, deixe em branco."}),e.jsxs(x,{children:[e.jsx(u,{variant:"body2",sx:{fontWeight:700,mb:1},children:"Campos (mapeie os que existirem)"}),[{key:"empresa",label:"Empresa",icon:e.jsx(ks,{fontSize:"small",sx:{mr:.75,color:"primary.main"}})},{key:"nome",label:"Nome",icon:e.jsx(Ts,{fontSize:"small",sx:{mr:.75,color:"primary.main"}})},{key:"telefone",label:"Telemóvel",icon:e.jsx(Ms,{fontSize:"small",sx:{mr:.75,color:"primary.main"}})},{key:"email",label:"E-mail",icon:e.jsx(zs,{fontSize:"small",sx:{mr:.75,color:"primary.main"}})}].map(t=>e.jsxs(x,{sx:{mb:1.5},children:[e.jsxs(x,{sx:{display:"flex",alignItems:"center",mb:.5},children:[t.icon,e.jsx(u,{variant:"body2",sx:{fontWeight:700},children:t.label})]}),e.jsxs(Fe,{fullWidth:!0,size:"small",children:[e.jsx(Oe,{children:"Selecione a coluna…"}),e.jsxs(Le,{sx:{width:"100%"},label:"Selecione a coluna…",value:f[t.key],displayEmpty:!0,renderValue:i=>i||"Selecione a coluna…",onChange:i=>$(c=>({...c,[t.key]:i.target.value})),children:[e.jsx(J,{value:"",children:e.jsx("em",{children:"—"})}),w.length>0?w.map(i=>({h:i,disabled:Object.values(f).includes(i)&&f[t.key]!==i})).map(({h:i,disabled:c})=>e.jsx(J,{value:i,disabled:c,children:i},i)):e.jsx(J,{disabled:!0,value:"__noheaders",children:"Nenhuma coluna detectada — carregue um arquivo"})]})]})]},t.key)),e.jsx(u,{variant:"body2",sx:{fontWeight:700,mb:1,mt:1.5},children:"Campos Opcionais"}),e.jsxs(x,{sx:{mb:1.5},children:[e.jsxs(x,{sx:{display:"flex",alignItems:"center",mb:.5},children:[e.jsx(Cs,{fontSize:"small",sx:{mr:.75,color:"warning.main"}}),e.jsx(u,{variant:"body2",sx:{fontWeight:700},children:"NIF (opcional)"})]}),e.jsxs(Fe,{fullWidth:!0,size:"small",children:[e.jsx(Oe,{children:"Selecione a coluna…"}),e.jsxs(Le,{sx:{width:"100%"},label:"Selecione a coluna…",value:f.nif,displayEmpty:!0,renderValue:t=>t||"Selecione a coluna…",onChange:t=>$(i=>({...i,nif:t.target.value})),children:[e.jsx(J,{value:"",children:"—"}),w.length>0?w.map(t=>({h:t,disabled:Object.values(f).includes(t)&&f.nif!==t})).map(({h:t,disabled:i})=>e.jsx(J,{value:t,disabled:i,children:t},t)):e.jsx(J,{disabled:!0,value:"__noheaders",children:"Nenhuma coluna detectada — carregue um arquivo"})]})]})]}),e.jsxs(Ie,{severity:"warning",variant:"outlined",children:[e.jsx(lt,{children:"Informação"}),"O campo NIF é opcional e pode ser deixado em branco. Registros sem NIF serão importados normalmente."]})]})]})})}),e.jsx(Ge,{item:!0,xs:12,sm:!0,sx:{pl:{xs:0,sm:.5},flexBasis:{sm:"40%",md:"40%",lg:"40%"},maxWidth:{sm:"40%",md:"40%",lg:"40%"}},children:e.jsxs(je,{spacing:1,children:[e.jsxs(F,{variant:"outlined",sx:{p:{xs:1,sm:1.25},borderRadius:2,height:typeof Qe=="number"?Qe+35:"auto"},children:[e.jsx(u,{variant:"subtitle1",sx:{fontWeight:700,mb:{xs:1,sm:1.25},fontSize:{xs:".95rem",sm:"1rem"},lineHeight:1.2},children:"Instruções"}),e.jsx(je,{spacing:{xs:.85,sm:1},children:[{n:1,t:"Prepare seu arquivo",d:"Organize os dados em formato XLS ou CSV com as colunas possíveis"},{n:2,t:"Faça o upload",d:"Arraste o arquivo ou clique para selecioná-lo"},{n:3,t:"Configurar os campos",d:"Mapeie as colunas do arquivo com os campos do sistema"},{n:4,t:"Confira e importe",d:"Verifique a prévia e confirme a importação"}].map(t=>e.jsxs(x,{sx:{display:"flex",gap:.5},children:[e.jsx(x,{sx:{width:{xs:16,sm:18},height:{xs:16,sm:18},borderRadius:"50%",bgcolor:"primary.main",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:{xs:10,sm:11},mt:.35},children:t.n}),e.jsxs(x,{children:[e.jsx(u,{variant:"body2",sx:{fontWeight:700,fontSize:{xs:".85rem",sm:".9rem"},lineHeight:1.25},children:t.t}),e.jsx(u,{variant:"body2",color:"text.secondary",sx:{fontSize:{xs:".78rem",sm:".84rem"},lineHeight:1.25},children:t.d})]})]},t.n))})]}),e.jsxs(F,{variant:"outlined",sx:{width:"100%",p:{xs:1,sm:1.25},borderRadius:2},ref:Ee,children:[e.jsx(u,{variant:"subtitle1",sx:{fontWeight:700,mb:.5,fontSize:{xs:".95rem",sm:"1rem"},lineHeight:1.2},children:"Campos"}),e.jsx(je,{spacing:.5,children:[{label:"Empresa",req:!1,icon:e.jsx(ks,{fontSize:"small"})},{label:"Nome",req:!1,icon:e.jsx(Ts,{fontSize:"small"})},{label:"Telemóvel",req:!1,icon:e.jsx(Ms,{fontSize:"small"})},{label:"E-mail",req:!1,icon:e.jsx(zs,{fontSize:"small"})},{label:"NIF",req:!1,icon:e.jsx(Cs,{fontSize:"small"})}].map(t=>e.jsxs(x,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(x,{sx:{color:"primary.main"},children:t.icon}),e.jsx(u,{variant:"body2",sx:{fontSize:{xs:".85rem",sm:".9rem"}},children:t.label})]}),e.jsx(U,{size:"small",label:t.req?"Obrigatório":"Opcional",color:t.req?"error":"default",variant:"outlined"})]},t.label))})]}),e.jsxs(F,{variant:"outlined",sx:{p:{xs:1,sm:1.25},borderRadius:2},children:[e.jsx(u,{variant:"subtitle1",sx:{fontWeight:700,mb:.5,fontSize:{xs:".95rem",sm:"1rem"},lineHeight:1.2},children:"Estatísticas"}),e.jsxs(je,{spacing:.4,children:[e.jsxs(x,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(u,{variant:"body2",sx:{fontSize:{xs:".8rem",sm:".86rem"}},children:"Registros no arquivo:"}),e.jsx(u,{variant:"body2",sx:{fontWeight:700,fontSize:{xs:".8rem",sm:".86rem"}},children:B.total})]}),e.jsxs(x,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(u,{variant:"body2",sx:{fontSize:{xs:".8rem",sm:".86rem"}},children:"Com NIF:"}),e.jsx(u,{variant:"body2",sx:{fontWeight:700,fontSize:{xs:".8rem",sm:".86rem"}},children:B.comNif})]}),e.jsxs(x,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(u,{variant:"body2",sx:{fontSize:{xs:".8rem",sm:".86rem"}},children:"Sem NIF:"}),e.jsx(u,{variant:"body2",sx:{fontWeight:700,fontSize:{xs:".8rem",sm:".86rem"}},children:B.semNif})]})]})]})]})})]}),(s==null?void 0:s.is_admin)&&e.jsxs(F,{variant:"outlined",sx:{p:2.5,mb:2,borderRadius:2},children:[e.jsx(u,{variant:"subtitle1",sx:{fontWeight:700,mb:.5},children:"Script de instrução/aviso"}),e.jsx(u,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Essa mensagem será exibida na página de Movimentação para todos os usuários."}),Ae&&e.jsx(Ie,{severity:Ae.type,sx:{mb:1},children:Ae.text}),e.jsx("textarea",{className:"textarea",rows:4,value:Ye,onChange:t=>He(t.target.value),placeholder:"Escreva instruções, avisos ou o roteiro de abordagem para a equipe."}),e.jsx(x,{sx:{display:"flex",gap:1,mt:1,justifyContent:"flex-end"},children:e.jsx(q,{variant:"contained",onClick:async()=>{Pe(null),Je(!0);try{await o(Ye),Pe({type:"success",text:"Script salvo com sucesso."})}catch(t){Pe({type:"error",text:(t==null?void 0:t.message)||"Falha ao salvar script"})}finally{Je(!1)}},disabled:Ps,children:"Salvar Script"})})]})]})}),e.jsx(x,{sx:{width:"100%",bgcolor:t=>t.palette.mode==="light"?"#f7f9fb":_("#ffffff",.03),pt:0,pb:1},children:e.jsx(qe,{maxWidth:!1,sx:{maxWidth:"1680px",mx:"auto",px:{xs:1.5,sm:2,md:2.5}},children:e.jsxs(F,{variant:"outlined",sx:{p:2.5,mb:2,borderRadius:2},children:[T&&e.jsx(Ie,{severity:T.type,sx:{mb:1.5},children:T.text}),e.jsxs(x,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:1,mb:.5,flexWrap:"wrap"},children:[e.jsx(u,{variant:"subtitle1",sx:{fontWeight:700},children:"Prévia dos Dados"}),e.jsx(x,{sx:{display:"flex",gap:1,flexWrap:"wrap",width:{xs:"100%",sm:"auto"},justifyContent:{xs:"stretch",sm:"flex-end"}},children:e.jsx(is,{title:p&&ge?"Importa os registros para o sistema":"Aceite o arquivo para importar",children:e.jsx(q,{variant:"contained",color:"success",onClick:Os,startIcon:G?e.jsx("span",{className:"inline-flex","aria-hidden":!0,children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",opacity:".25"}),e.jsx("path",{d:"M22 12a10 10 0 0 1-10 10"})]})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":!0,children:e.jsx("path",{d:"M19.35 10.04A7.49 7.49 0 0 0 12 4a7.5 7.5 0 0 0-7.45 8.49A5.994 5.994 0 0 0 6 22h11a5 5 0 0 0 2.35-9.96z"})}),sx:t=>({height:44,px:2,fontWeight:800,letterSpacing:.2,borderRadius:2,textTransform:"none",boxShadow:t.shadows[1],opacity:p&&ge?1:.95,transition:"all .2s ease","&:hover":{boxShadow:t.shadows[2],transform:"translateY(-1px)"},width:{xs:"100%",sm:"auto"}}),children:G?"Importando…":"Importar"})})})]}),e.jsx(u,{variant:"body2",color:"text.secondary",sx:{mb:1.5},children:"Visualize como os dados serão importados"}),e.jsx(F,{variant:"outlined",sx:{borderRadius:2,overflow:"hidden",width:"100%"},children:e.jsx(x,{sx:{width:"100%",overflowX:"auto"},children:e.jsxs(gs,{size:"small",sx:{minWidth:980},children:[e.jsx(vs,{children:e.jsx(le,{children:["Empresa","Nome","Telemóvel","E-mail","NIF"].map(t=>e.jsx(H,{sx:{fontWeight:700},children:t},t))})}),e.jsxs(bs,{children:[S.slice(0,50).map((t,i)=>{const c=t[f.empresa]||"",y=t[f.nome]||"",h=t[f.telefone]||"",v=t[f.email]||"",M=f.nif&&t[f.nif]||"";return e.jsxs(le,{children:[e.jsx(H,{children:c}),e.jsx(H,{children:y}),e.jsx(H,{children:h}),e.jsx(H,{children:v||"—"}),e.jsx(H,{children:M||"—"})]},i)}),!S.length&&e.jsx(le,{children:e.jsx(H,{colSpan:5,children:e.jsx(u,{variant:"body2",color:"text.secondary",children:"Nenhum dado para pré-visualizar"})})})]})]})})}),S.length>0&&e.jsxs(u,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:["Mostrando ",Math.min(50,S.length)," de ",S.length," registros encontrados no arquivo"]})]})})}),e.jsx(x,{sx:{width:"100%",bgcolor:t=>t.palette.mode==="dark"?t.palette.background.paper:"#FFFFFF",borderTop:t=>`1px solid ${t.palette.divider}`},children:e.jsx(qe,{maxWidth:!1,sx:{maxWidth:"1680px",mx:"auto",px:{xs:1.5,sm:2,md:2.5}},children:e.jsxs(x,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:1.25,minHeight:56,textAlign:"center"},children:[e.jsx(u,{variant:"body2",sx:{fontWeight:500,color:t=>t.palette.text.secondary},children:"© 2025 Sistema Sol-Online • Módulo de Importação • Versão 1.0"}),e.jsxs(x,{sx:{display:"flex",gap:1,alignItems:"center",justifyContent:"center",mt:.75,"& .MuiChip-label":{fontWeight:500}},children:[e.jsx(u,{variant:"body2",color:"text.secondary",children:"Formatos suportados:"}),e.jsx(U,{size:"medium",label:"XLS",color:"primary",variant:"outlined"}),e.jsx(U,{size:"medium",label:"CSV",color:"success",variant:"outlined"})]})]})})}),e.jsxs(ct,{open:ue,onClose:()=>!G&&O(!1),fullWidth:!0,maxWidth:"lg",children:[e.jsx(dt,{children:"Pré-visualização e confirmação"}),e.jsxs(pt,{dividers:!0,children:[Hs!=="csv"&&we.length>1&&e.jsx(x,{sx:{mb:2},children:e.jsxs(Fe,{size:"small",children:[e.jsx(Oe,{id:"sheet-label",children:"Planilha"}),e.jsx(Le,{labelId:"sheet-label",label:"Planilha",value:Ce,onChange:async t=>{fe(t.target.value),await Vs(t.target.value),xe(1)},children:we.map(t=>e.jsx(J,{value:t,children:t},t))}),e.jsx(mt,{children:"Selecione a aba da pasta de trabalho"})]})}),e.jsx(F,{variant:"outlined",sx:{borderRadius:2,overflow:"hidden",width:"100%"},children:e.jsx(x,{sx:{width:"100%",overflowX:"auto"},children:e.jsxs(gs,{size:"small",sx:{minWidth:680},children:[e.jsx(vs,{children:e.jsx(le,{children:["Empresa","Nome","Telemóvel","E-mail","NIF"].map(t=>e.jsx(H,{sx:{fontWeight:700},children:t},t))})}),e.jsxs(bs,{children:[S.slice((L-1)*D,L*D).map((t,i)=>{const c=t[f.empresa]||"",y=t[f.nome]||"",h=t[f.telefone]||"",v=t[f.email]||"",M=f.nif&&t[f.nif]||"";return e.jsxs(le,{children:[e.jsx(H,{children:c}),e.jsx(H,{children:y}),e.jsx(H,{children:h}),e.jsx(H,{children:v||"—"}),e.jsx(H,{children:M||"—"})]},i)}),!S.length&&e.jsx(le,{children:e.jsx(H,{colSpan:5,children:e.jsx(u,{variant:"body2",color:"text.secondary",children:"Nenhum dado para pré-visualizar"})})})]})]})})}),e.jsxs(x,{sx:{mt:1.5,display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:1},children:[e.jsxs(u,{variant:"caption",color:"text.secondary",children:["Mostrando ",Math.min(D,Math.max(0,S.length-(L-1)*D))," de ",S.length," registros"]}),e.jsxs(je,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(q,{size:"small",variant:"outlined",disabled:L<=1,onClick:()=>xe(t=>Math.max(1,t-1)),children:"Anterior"}),e.jsxs(u,{variant:"body2",children:["Página ",L," / ",Math.max(1,Math.ceil(S.length/D))]}),e.jsx(q,{size:"small",variant:"outlined",disabled:L>=Math.ceil(S.length/D),onClick:()=>xe(t=>Math.min(Math.ceil(S.length/D)||1,t+1)),children:"Próxima"})]})]})]}),e.jsxs(ut,{children:[e.jsx(q,{onClick:()=>{G||(O(!1),b(null),N([]),I([]),$({empresa:"",nome:"",telefone:"",email:"",nif:""}),A([]),fe(""),ke(null),he(""),X(""),re(!1))},disabled:G,children:"Cancelar"}),e.jsx(q,{onClick:()=>{re(!0),O(!1)},variant:"contained",color:"primary",disabled:G||!p,children:"Aceitar arquivo"})]})]})]})}export{ra as default};
